<div class="container">
  <h1>Forecast for the destinations available in Reservamos</h1>
  <span><%= @city_name %></span>

  <%= form_with url: "/search", method: :get do |form| %>
    <%= form.label :query, "Search city by name:" %>
    <br>
    <%= form.text_field :query %>
    <%= form.submit "Search" %>
  <% end %>

  <% if @data %>
    <table>
      <% previous_day = nil %>
      <% @data.each do |weather| %>
        <% current_day = Time.at(weather["dt"]).strftime("%A") %>
        <% if current_day != previous_day %>
          <tr>
            <th><%= current_day %></th>
            <th>Min</th>
            <th>Max</th>
          </tr>
          <% previous_day = current_day %>
        <% end %>
        <tr>
          <td><%= Time.at(weather["dt"]).strftime("%H:%M") %></td>
          <td><%= weather["main"]["temp_min"] %>°C</td>
          <td><%= weather["main"]["temp_max"] %>°C</td>
        </tr>
      <% end %>
    </table>
  <% end %>
</div>
